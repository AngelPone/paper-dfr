\documentclass[11pt,a4paper]{article}

\usepackage{amssymb,amsmath}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\usepackage{multirow}
\usepackage{outlines}
\usepackage{caption}
\captionsetup[table]{name=Table R}
\makeatletter
\def\fnum@table{\tablename\thetable}
\makeatother
\captionsetup[figure]{name=Figure R}
\makeatletter
\def\fnum@figure{\figurename\thefigure}
\makeatother
\hypersetup{
  pdfborder={0 0 0},
  breaklinks=true,
  colorlinks=true,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue}
\usepackage{geometry}
\geometry{margin=1in}
\usepackage{xcolor, graphicx, color, array, colortbl}
\usepackage{longtable,booktabs}
\let\code=\texttt
\let\pkg=\texttt
\let\proglang=\textsf

%% BibTeX
\usepackage[style=authoryear-comp, backend=biber, natbib=true, maxcitenames=2, maxbibnames=99, safeinputenc]{biblatex}
\renewbibmacro{in:}{%
  \ifentrytype{article}{}{%
  \printtext{\bibstring{in}\intitlepunct}}}
\DeclareNameAlias{sortname}{family-given}
\addbibresource{../manuscript/references.bib}

\usepackage{enumitem}
\setlist[enumerate,itemize]{listparindent=\parindent,leftmargin=1.5em}% Indented paragraphs within lists
\setlength{\itemsep}{0.0pt}

%% Reply Environment: \RE[]{} -> blue text, \RE{} -> Re: blue text
\newcommand{\RE}[2][Re:~]{{\color{blue}\textbf{#1}#2}}

\usepackage{makecell}

\renewcommand\theadalign{bc}
\renewcommand\theadfont{\bfseries}
\renewcommand\theadgape{\Gape[4pt]}
\renewcommand\cellgape{\Gape[4pt]}

\RequirePackage{setspace}
\spacing{1.5}


\title{\bf\Large Authors' Responses to Reviewers Comments for \\
  ``Discrete Forecast Reconciliation'' }

\author{}
\date{}

\begin{document}
\maketitle

\RE[]{We thank the Editor and the three anonymous reviewers for reviewing our paper. We are also grateful for the insightful comments and suggestions. In this revision, we have addressed all the comments raised by the reviewers, providing a point-by-point response to each comment made by the review team.}

\section*{Responses to Reviewer 1}\label{reviewer-1-comments}

\RE[]{First, we would like to thank the reviewer for the time of reviewing our paper. We have tried our best to address all of the comments and suggestions. Below we provide a point-by-point response to these comments.}

\textit{In this paper, the authors proposed a discrete forecast reconciliation (DFR) algorithm to tackle the forecast reconciliation problem for discrete hierarchical time series. A variant of the algorithm, namely stepwise DFR (SDFR), is proposed for the dimensionality issue by breaking down the complex hierarchies into simpler ones. The performance of this algorithm is evaluated in two simulation experiments and two empirical experiments with real data. The result shows that overall, the proposed algorithm outperforms its counterparts in terms of accuracy. This paper addresses an important issue in forecasting that is significant both theoretically and practically. In what follows, I list several comments which I hope will help the authors to further improve this paper.}

\begin{enumerate}%[leftmargin=*, listparindent=1.25em, parsep=10pt]%[leftmargin=*]
\item \textit{Applicability}

  \begin{enumerate}
    \item \textit{The authors pointed out (in p.26, l.552) that the algorithm ``cannot be easily applied to a large hierarchy'' due to the dimensionality issues. This limits the applicability of the proposed algorithm. From a practical perspective, it may be necessary to offer guidelines as to which hierarchies fall into the ``large'' category. }

    \RE{Thank you for your comment. We have included a paragraph in the Discussion section to discuss how the curse of dimensionality in a reconciliation model including computational issues. In particular we note that the curse of dimensionality applies to multivariate discrete forecasting in general, since for large dimension, the number of discrete points in the support can be so large as to render any method infeasible. Also for a large number of bottom level series, the corresponding top level series will have counts so large, that it begins to behave more like a continuous variable. To resolve this issue will require a method that can deal with mixed discrete-continuous hierarchies. While this lies beyond the scope of our current work, we feel that our current contribution which reconciles discrete distributions of moderate dimension could form an important part in solving the more ambitious problem of mixed discrete-continuous hierarchies.\\  
    	
    	
    	We have also added Table~5, which shows the characteristics of multiple hierarchies and the corresponding computational time used to implement the proposed algorithms. This can guide practitioners on whether a hierarchy is ``large'' accordingly.\\
   }
    


    \item \textit{Also, DFR does not show a definitive advantage over its counterparts (the bottom-up and top-down approaches), for which the optimization effort is not required. Hence it is not uncertain whether the marginal benefit of accuracy improvement can compensate for the additional computational cost. I suggest the authors further report the computation time for each of the forecasting methods under the various scenarios.}

    \RE{Thank you for your suggestion. As mentioned in your previous comment, we have added Table~5 to illustrate the relationship between the hierarchy size and computational time. Here we show that for many of our examples, computational cost is not prohibitive taking 5 minutes for one of our empirical applications and 25 minutes for the other (the simulation studies are computed almost instantly). Furthermore, although reconciliation methods do not always outperform simpler benchmarks (which we reiterate are special cases of our new framework), in almost all our examples DFR or SDFR significantly outperforms the base forecasts.}


  \end{enumerate}

\item \textit{Contribution. In the introduction, the authors merely summarised their work without clarifying the contribution. Thus, it is unclear to me the contribution of this research from the existing algorithms in the continuous case. If the problem formulation is an analogue of the continuous case, what about the algorithm design? A review or a brief summarization of forecast reconciliation in the continuous case should be added. The emphasis should be given to what motivates you to develop the new algorithm.}

\RE{
  Thank you for your valuable feedback. In response, we have revised the Introduction to enhance clarity and logical flow. The revised version now presents a review of continuous reconciliation approaches mainly in the second and third paragraphs, as well as an explanation of why these methods break down in the discrete setting. This is followed by a detailed discussion of motivation behind our study, including a review of existing methodologies for count hierarchical time series.
}


\item \textit{Exposition. This manuscript can benefit from further improvement in terms of exposition and presentation. }
\begin{enumerate}
    \item \textit{There are parts that are hard to read and sentences with grammatical errors and spelling errors e.g. the last sentence in p.2.}
    
    \RE{Thank you for pointing out this matter. We have removed this sentence and thoroughly reviewed the remaining text for sentence structure and spelling accuracy.}
    \item \textit{The introduction of costs (in p.10) can be moved closer to movement restriction since it can be represented either as a penalty or a constraint.}
    
    \RE{We thank the reviewer for the very nice suggestion. We have combined the ``Costs'' and ``Movement Restriction'' subsections and removed the $\mathcal{L}_1$ cost part from the objective function. The $\mathcal{L}_1$ cost now only serves as a measure of how close an incoherent point is to a coherent point.}

\end{enumerate}




\item \textit{ Minor issues }

  \begin{enumerate}
    \item  \textit{p.6, l.127 predictive}

    \RE{Done. Thank you.}

    \item \textit{p.9, l.199 explain what ``strictly proper'' means}

    \RE{Thank you for your suggestion. We now include an explanation about the strictly proper scoring rules.}



    \item \textit{p.9, last line. $k = 1 \rightarrow$ should it be $z_k = 1$?}
    
    \RE{Done. Thank you.}
    \item \textit{p.11, l.214. Not clear how to define the costs of $\mathcal{L}_1$ cannot be used}
    
    \RE{Thank you for highlighting this issue. We have combined the ``Costs'' and ``Movement Restriction'' subsections and removed the $\mathcal{L}_1$ cost part from the objective function. The $\mathcal{L}_1$ cost now only serves as a measure of how close an incoherent point is to a coherent point.}

  \end{enumerate}

\end{enumerate}
\newpage
\section*{Responses to Reviewer 2}\label{reviewer-2-comments}

\RE[]{First, we would like to thank the reviewer for the time of reviewing our paper. We have tried our best to address all of the comments and suggestions. Below we provide a point-by-point response to these comments.}

\textit{The paper is addressing an important issue on reconciling hierarchical probabilistic count forecasts. Diverse setting to evaluate the new approach was devised. For example, a forecasting application on mortality threshold exceedance in Australia is an interesting example based on mortality catastrophe bonds.}

\begin{enumerate}
    \item \textit{However, the discussion on the methodology requires more explanation. The method could use other probabilistic evaluation measures such as discrete ranked probability score.}
   
    \RE{Thank you for your comment. As we have mentioned in Section~3.1, our method could employ other probabilistic evaluation measures, such as spherical score and logarithmic score. We choose Brier score instead of others because it can seamlessly fit into our framework by formulating an objective function that can be solved through quadratic programming.
    
    However, incorporating discrete ranked probability score (DRPS) into our method is challenging because DRPS is undefined on multivariate discrete distribution. The problem arises since there is no unique way to defining a rank between vectors of discrete values. For example, there is no unambiguous convention for ranking the values (1, 0) and (0, 1). Therefore, we keep using the Brier score in the paper and clarify the applicability of other probabilistic evaluation measures in Section~3.1.
    }

    \item \textit{The discussion of the empirical results is difficult to be read.}
    
    \RE{We have rewritten the section on empirical results to enhance clarity.}
    
    \item \textit{Overall, a good research question was studied, but more clear explanation on the methodology and impactful discussion on the empirical result are needed.}
    
    \RE{In response, we have revised the Introduction to include a detailed discussion of the primary motivations for our study. We also summarise our contributions to the field in the introduction and, as stated above, we have rewritten the section on empirical results to enhance clarity.}
    
\end{enumerate}




\newpage
\section*{Responses to Reviewer 3}\label{reviewer-3-comments}

\RE[]{First, we would like to thank the reviewer for the time of reviewing our paper. We have tried our best to address all of your comments and suggestions. Below we provide a point-by-point response to your comments.}


\textit{The paper tackles a substantial issue, and the proposed framework offers a significant contribution to the field of probabilistic forecast reconciliation. However, it's crucial to note that while addressing this important problem is commendable, the mere proposal of a framework for generating reconciled count forecasts may not be sufficient. It is essential to demonstrate its superiority over simpler approaches to establish its value and using realistic setting and datasets.}

\begin{enumerate}
  \item \textit{One advantage of the proposed methodology is its ability to generate reconciled forecast distributions in count form. In evaluating forecast performance, a fair benchmark would involve using existing reconciliation approaches that use integer base forecasts. However, it's important to note that in these cases, the reconciled forecasts may not necessarily be in count form. In such instances, rounding non-integer values to whole numbers may still be effective. Have you considered evaluating the performance of forecasting when non-integer forecast results are both rounded up and rounded down, and comparing these results with your proposed approach?}

  \RE{Thank you for your comment. We should note that rounding coherent non-integer point forecasts leads to incoherent integer point forecasts. For example, consider a hierarchy with four series, denoted by Y=A+B+C. The non-integer forecasts for these series could be 3.2, 0.6, 1.7, 0.9, respectively, and the rounding forecasts are 3, 1, 2, 1, which are no longer coherent. A similar example is now provided in the paper to make this clear and the same argument applies to distributional forecasts. We have now mentioned the problem of rounding in dealing with non-integer forecasts when we motivate this study in the Introduction section.}


  \item \textit{What is the purpose of including such artificial examples in the simulation given that there are many real datasets that could be used in the paper, could we make it more realistic?}

  \RE{Thank you for your suggestion. Our second simulation experiment simulates daily series of intermittent nature, which is a common scenario widely seen in supply chain and retail. Furthermore, following your suggestion, we have now replaced our second empirical experiment with a subset of the M5 (\citealp{makridakisM5AccuracyCompetition2022}) dataset.}

  \item \textit{Author mentioned that non-integer forecasts may introduce additional costs from an operational research standpoint, as they require conversion into actionable decisions. However, the accuracy of this claim is uncertain. To my knowledge, there is no study that quantifies the cost associated with integrating non-integer forecasts into decision-making processes. While an integer forecast is often preferred for operational research problems, in practice, rounding forecasts might provide a pragmatic solution to address these concerns. Please clarify this in the revised paper.}
  
  \RE{Thank you for highlighting this issue. We agree with you that there is no study on quantifying the cost of rounding non-integer forecasts. We also agree that in operational settings where only a mean forecast is required, non-integer forecasts may be sufficient. However, some operational decisions may depend on the full multivariate discrete distribution (e.g. the probability that there are no sales in a given week may be a useful input into decision making). In this setting, a method that leads to probabilistic forecasts that have a non-integer support cannot be used. This is now discussed extensively in the introduction, particularly in the fourth paragraph.}

  \item \textit{Since the author emphasises the significance of the proposed framework for low-count time series and considering the availability of such datasets in the public domain, I recommend that the authors include examples from such datasets in their empirical studies. This may include time series with intermittent nature.}
  
  \RE{Thank you for your suggestion. We have now replaced our second empirical experiment with a subset of M5 (\citealp{makridakisM5AccuracyCompetition2022}) dataset.}

  \item \textit{Could the authors consider incorporating an empirical distribution of the historical time series as a benchmark method for constructing the forecast distribution and for reconciliation? Sometimes, this simple, naive approach can be remarkably effective.}
  
  \RE{We have now included the empirical distribution as one of the benchmarks in both our simulation and empirical studies. While it is competitive compared to base forecast, discrete bottom-up and discrete top-down, the proposed methodology performs better in most cases.}
  
  \item \textit{Considering the emphasis on low-volume data, it raises a question as to why the authors opted for a yearly time series in the empirical section of the study.}
 
  \RE{Thank you for pointing out this issue. We have now removed this yearly time series forecasting experiment and used a subset of M5 (\citealp{makridakisM5AccuracyCompetition2022}) dataset instead.}
  
  \item \textit{Could the authors provide insights on the computational cost associated with the proposed approach? This aspect becomes particularly crucial when weighing the potential benefits of the proposed approach against simpler methods like rounding forecasts, especially in more realistic scenarios including big hierarchies where high computational costs are a concern.}
  
  \RE{Thank you for your advice. We have added a paragraph in the Discussion section to discuss how the curse of dimensionality in a reconciliation model affects the corresponding computation time. We have also added Table 5, which shows the characteristics of multiple hierarchies and the corresponding computational time used to implement the proposed algorithms.}


\end{enumerate}

% \newpage
% \bibliographystyle{agsm}
% \bibliography{mybib}
\printbibliography

\end{document}